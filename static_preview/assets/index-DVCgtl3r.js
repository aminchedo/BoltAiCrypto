import{c as v,w as _,x as ae,y as H,z as le,E as K,F as V,G as I,H as re,r as g,R as Z,j as e,q as R,D as ne,I as z,J as ee,Z as oe,K as ce,N as ie,A as de,S as xe,O as me,P as A,Q as B,U as he,V as be,W as pe,X as fe,Y as X}from"./index-BcU7k0PE.js";import{L as ue,F as q}from"./layers-CSmaTt8L.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=v("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=v("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=v("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=v("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=v("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=v("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=v("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=v("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=v("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=v("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=v("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=v("GitCompare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=v("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=v("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=v("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=v("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=v("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=v("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=v("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=v("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=v("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=v("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=v("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=v("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=v("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=v("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=v("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=v("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function E(n,o){const s=+_(n)-+_(o);return s<0?-1:s>0?1:s}function $e(n){return ae(n,Date.now())}function Oe(n,o,s){const[t,l]=H(s==null?void 0:s.in,n,o),c=t.getFullYear()-l.getFullYear(),x=t.getMonth()-l.getMonth();return c*12+x}function He(n){return o=>{const t=(n?Math[n]:Math.trunc)(o);return t===0?0:t}}function ze(n,o){return+_(n)-+_(o)}function Be(n,o){const s=_(n,o==null?void 0:o.in);return s.setHours(23,59,59,999),s}function Pe(n,o){const s=_(n,o==null?void 0:o.in),t=s.getMonth();return s.setFullYear(s.getFullYear(),t+1,0),s.setHours(23,59,59,999),s}function Ke(n,o){const s=_(n,o==null?void 0:o.in);return+Be(s,o)==+Pe(s,o)}function Ve(n,o,s){const[t,l,c]=H(s==null?void 0:s.in,n,n,o),x=E(l,c),a=Math.abs(Oe(l,c));if(a<1)return 0;l.getMonth()===1&&l.getDate()>27&&l.setDate(30),l.setMonth(l.getMonth()-x*a);let b=E(l,c)===-x;Ke(t)&&a===1&&E(t,c)===1&&(b=!1);const r=x*(a-+b);return r===0?0:r}function Xe(n,o,s){const t=ze(n,o)/1e3;return He(s==null?void 0:s.roundingMethod)(t)}function qe(n,o,s){const t=re(),l=(s==null?void 0:s.locale)??t.locale??le,c=2520,x=E(n,o);if(isNaN(x))throw new RangeError("Invalid time value");const a=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:x}),[b,r]=H(s==null?void 0:s.in,...x>0?[o,n]:[n,o]),i=Xe(r,b),d=(K(r)-K(b))/1e3,m=Math.round((i-d)/60);let p;if(m<2)return s!=null&&s.includeSeconds?i<5?l.formatDistance("lessThanXSeconds",5,a):i<10?l.formatDistance("lessThanXSeconds",10,a):i<20?l.formatDistance("lessThanXSeconds",20,a):i<40?l.formatDistance("halfAMinute",0,a):i<60?l.formatDistance("lessThanXMinutes",1,a):l.formatDistance("xMinutes",1,a):m===0?l.formatDistance("lessThanXMinutes",1,a):l.formatDistance("xMinutes",m,a);if(m<45)return l.formatDistance("xMinutes",m,a);if(m<90)return l.formatDistance("aboutXHours",1,a);if(m<V){const u=Math.round(m/60);return l.formatDistance("aboutXHours",u,a)}else{if(m<c)return l.formatDistance("xDays",1,a);if(m<I){const u=Math.round(m/V);return l.formatDistance("xDays",u,a)}else if(m<I*2)return p=Math.round(m/I),l.formatDistance("aboutXMonths",p,a)}if(p=Ve(r,b),p<12){const u=Math.round(m/I);return l.formatDistance("xMonths",u,a)}else{const u=p%12,N=Math.trunc(p/12);return u<3?l.formatDistance("aboutXYears",N,a):u<9?l.formatDistance("overXYears",N,a):l.formatDistance("almostXYears",N+1,a)}}function Ge(n,o){return qe(n,$e(n),o)}const Je=(n,o=!0)=>{g.useEffect(()=>{if(!o)return;const s=t=>{const l=t.target;if(!((l.tagName==="INPUT"||l.tagName==="TEXTAREA"||l.isContentEditable)&&!(t.ctrlKey&&t.key.toLowerCase()==="s")))for(const c of n){const x=t.key.toLowerCase()===c.key.toLowerCase(),a=c.ctrlKey===void 0||t.ctrlKey===c.ctrlKey,b=c.shiftKey===void 0||t.shiftKey===c.shiftKey,r=c.altKey===void 0||t.altKey===c.altKey;if(x&&a&&b&&r){t.preventDefault(),c.handler(t);break}}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[n,o])},Qe=[{id:"popular",label:"محبوب",icon:R,symbols:["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","ADAUSDT"]},{id:"defi",label:"دیفای",icon:ue,symbols:["UNIUSDT","AAVEUSDT","LINKUSDT","MKRUSDT","SUSHIUSDT"]},{id:"layer1",label:"لایه ۱",icon:De,symbols:["BTCUSDT","ETHUSDT","SOLUSDT","AVAXUSDT","DOTUSDT"]},{id:"top10",label:"ده برتر",icon:O,symbols:["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","XRPUSDT","ADAUSDT","DOGEUSDT","TRXUSDT","MATICUSDT","LTCUSDT"]},{id:"stablecoins",label:"استیبل‌کوین",icon:ne,symbols:["BUSDUSDT","USDCUSDT","DAIUSDT"]}],Ye=({onSelectGroup:n})=>{const[o,s]=Z.useState(null),t=l=>{s(l.id),n(l.symbols)};return e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-300",children:"🎯 فیلترهای سریع"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Qe.map(l=>{const c=l.icon,x=o===l.id;return e.jsxs("button",{onClick:()=>t(l),className:`
                inline-flex items-center gap-2 px-4 py-2 rounded-lg font-medium
                transition-all duration-200 border
                ${x?"bg-cyan-500/20 border-cyan-500/50 text-cyan-400 shadow-lg shadow-cyan-500/20":"bg-slate-700/30 border-slate-600/30 text-slate-300 hover:bg-slate-700/50 hover:border-slate-500/50"}
              `,"aria-pressed":x,children:[e.jsx(c,{className:"w-4 h-4"}),e.jsx("span",{children:l.label}),e.jsxs("span",{className:"text-xs opacity-70",children:["(",l.symbols.length,")"]})]},l.id)})})]})},We=({symbols:n,onChange:o,disabled:s})=>{const[t,l]=g.useState(""),[c,x]=g.useState(!1),b=["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","XRPUSDT","ADAUSDT","DOGEUSDT","MATICUSDT","DOTUSDT","LTCUSDT","AVAXUSDT","LINKUSDT","UNIUSDT","ATOMUSDT","ETCUSDT","XLMUSDT","NEARUSDT","ALGOUSDT"].filter(p=>p.toLowerCase().includes(t.toLowerCase())&&!n.includes(p)).slice(0,8),r=p=>{const u=p.trim().toUpperCase();u&&!n.includes(u)&&o([...n,u]),l(""),x(!1)},i=p=>{o(n.filter(u=>u!==p))},d=p=>{p.key==="Enter"?(p.preventDefault(),t.trim()&&r(t)):p.key==="Escape"&&x(!1)},m=p=>{l(p),x(p.length>0)};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-300",children:["📊 نمادها (",n.length," انتخاب شده)"]}),n.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 p-3 bg-slate-900/50 rounded-lg border border-slate-700/30",children:n.map(p=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-slate-700/50 text-slate-200 rounded-lg text-sm font-medium border border-slate-600/30",children:[p,e.jsx("button",{onClick:()=>i(p),disabled:s,className:"p-0.5 hover:bg-red-500/20 rounded transition-colors disabled:opacity-50","aria-label":`حذف ${p}`,children:e.jsx(L,{className:"w-3 h-3"})})]},p))}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",value:t,onChange:p=>m(p.target.value),onKeyDown:d,onFocus:()=>t&&x(!0),onBlur:()=>setTimeout(()=>x(!1),200),placeholder:"نماد را تایپ کنید (مثال: BTCUSDT)",disabled:s,className:"w-full px-4 py-3 pr-10 bg-slate-700/50 border border-slate-600/50 rounded-lg text-white placeholder-slate-400 focus:border-cyan-500/50 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed"}),t&&e.jsx("button",{onClick:()=>{l(""),x(!1)},className:"absolute left-3 top-1/2 -translate-y-1/2 p-1 hover:bg-slate-600/50 rounded transition-colors","aria-label":"پاک کردن",children:e.jsx(L,{className:"w-4 h-4 text-slate-400"})})]}),c&&b.length>0&&e.jsxs("div",{className:"absolute z-10 mt-2 w-full bg-slate-800 border border-slate-700 rounded-lg shadow-xl overflow-hidden",children:[e.jsx("div",{className:"p-2 text-xs text-slate-400 border-b border-slate-700",children:"پیشنهادات:"}),b.map(p=>e.jsxs("button",{onClick:()=>r(p),className:"w-full px-4 py-2 text-right hover:bg-slate-700/50 text-slate-200 transition-colors flex items-center justify-between group",children:[e.jsx("span",{className:"font-medium",children:p}),e.jsx(_e,{className:"w-4 h-4 text-cyan-400 opacity-0 group-hover:opacity-100 transition-opacity"})]},p))]})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"💡 نماد را تایپ کنید و Enter بزنید. حداقل ۱ نماد لازم است."})]})},Ze=[{id:"scalp",label:"⚡ اسکالپ",timeframes:["1m","5m","15m"]},{id:"day",label:"📈 روزانه",timeframes:["15m","1h","4h"]},{id:"swing",label:"📊 سوئینگ",timeframes:["4h","1d","1w"]}],es=["1m","5m","15m","30m","1h","2h","4h","6h","12h","1d","1w"],ss=({timeframes:n,onChange:o,disabled:s})=>{const t=c=>{if(n.includes(c)){if(n.length===1)return;o(n.filter(x=>x!==c))}else o([...n,c])},l=c=>{o(c.timeframes)};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-300 flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"}),"بازه‌های زمانی (",n.length," انتخاب شده)"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ze.map(c=>e.jsx("button",{onClick:()=>l(c),disabled:s,className:"px-3 py-1.5 bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-purple-300 rounded-lg text-sm font-medium hover:from-purple-500/30 hover:to-pink-500/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c.label},c.id))}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 gap-2",children:es.map(c=>{const x=n.includes(c);return e.jsx("button",{onClick:()=>t(c),disabled:s,className:`
                px-3 py-2 rounded-lg font-semibold text-sm transition-all duration-200 border
                ${x?"bg-cyan-500/20 border-cyan-500/50 text-cyan-300 shadow-lg shadow-cyan-500/10":"bg-slate-700/30 border-slate-600/30 text-slate-400 hover:bg-slate-700/50 hover:border-slate-500/50 hover:text-slate-300"}
                ${s?"opacity-50 cursor-not-allowed":""}
              `,"aria-pressed":x,children:c},c)})}),e.jsx("p",{className:"text-xs text-slate-400",children:"💡 حداقل ۱ بازه زمانی لازم است. بازه‌های کوتاه‌تر برای معاملات سریع‌تر مناسب‌اند."})]})},ts=({filters:n,onChange:o,isExpanded:s,onToggle:t})=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:t,className:"w-full flex items-center justify-between px-4 py-3 bg-slate-700/30 border border-slate-600/30 rounded-lg hover:bg-slate-700/50 transition-colors text-slate-300",children:[e.jsxs("span",{className:"flex items-center gap-2 font-semibold",children:[e.jsx(Ae,{className:"w-4 h-4"}),"فیلترهای پیشرفته"]}),s?e.jsx(Ne,{className:"w-5 h-5"}):e.jsx(ve,{className:"w-5 h-5"})]}),s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-slate-900/30 border border-slate-700/30 rounded-lg animate-in fade-in slide-in-from-top-2 duration-300",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"محدوده امتیاز"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",min:"0",max:"1",step:"0.1",value:n.scoreMin,onChange:l=>o({scoreMin:parseFloat(l.target.value)||0}),className:"w-20 px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-lg text-white text-sm focus:border-cyan-500/50 focus:outline-none"}),e.jsx("span",{className:"text-slate-400",children:"تا"}),e.jsx("input",{type:"number",min:"0",max:"1",step:"0.1",value:n.scoreMax,onChange:l=>o({scoreMax:parseFloat(l.target.value)||1}),className:"w-20 px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-lg text-white text-sm focus:border-cyan-500/50 focus:outline-none"})]}),e.jsxs("p",{className:"text-xs text-slate-400",children:["فقط امتیازهای بین ",n.scoreMin," و ",n.scoreMax]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"تغییر قیمت (۲۴ ساعت)"}),e.jsxs("select",{value:n.priceChange,onChange:l=>o({priceChange:l.target.value}),className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-lg text-white text-sm focus:border-cyan-500/50 focus:outline-none",children:[e.jsx("option",{value:"any",children:"همه"}),e.jsx("option",{value:"gainers",children:"صعودی (>0%)"}),e.jsx("option",{value:"losers",children:"نزولی (<0%)"}),e.jsx("option",{value:"bigmovers",children:"حرکت بزرگ (>5%)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"حداقل حجم معاملات"}),e.jsx("input",{type:"number",min:"0",step:"1000000",value:n.volumeMin,onChange:l=>o({volumeMin:parseFloat(l.target.value)||0}),placeholder:"۰ (بدون محدودیت)",className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-lg text-white text-sm focus:border-cyan-500/50 focus:outline-none"}),e.jsx("p",{className:"text-xs text-slate-400",children:"حجم به دلار (مثلاً ۱۰۰۰۰۰۰۰ = ۱۰M)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"حداقل تعداد سیگنال فعال"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"range",min:"0",max:"9",value:n.signalCountMin,onChange:l=>o({signalCountMin:parseInt(l.target.value)}),className:"flex-1 accent-cyan-500"}),e.jsx("span",{className:"w-12 px-2 py-1 bg-slate-700/50 border border-slate-600/50 rounded text-center text-white text-sm font-mono",children:n.signalCountMin})]})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"توافق بازه‌های زمانی"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"any",label:"حداقل یکی"},{value:"majority",label:"اکثریت"},{value:"full",label:"اجماع کامل"}].map(l=>e.jsx("button",{onClick:()=>o({tfAgreement:l.value}),className:`
                    px-4 py-2 rounded-lg text-sm font-medium transition-all border
                    ${n.tfAgreement===l.value?"bg-cyan-500/20 border-cyan-500/50 text-cyan-300":"bg-slate-700/30 border-slate-600/30 text-slate-400 hover:bg-slate-700/50"}
                  `,children:l.label},l.value))})]}),e.jsx("div",{className:"md:col-span-2 flex justify-end",children:e.jsx("button",{onClick:()=>o({scoreMin:0,scoreMax:1,priceChange:"any",volumeMin:0,signalCountMin:0,tfAgreement:"any"}),className:"px-4 py-2 bg-red-500/20 border border-red-500/30 text-red-400 rounded-lg text-sm font-medium hover:bg-red-500/30 transition-colors",children:"بازنشانی فیلترها"})})]})]}),as=[{value:60,label:"۱ دقیقه"},{value:300,label:"۵ دقیقه"},{value:900,label:"۱۵ دقیقه"},{value:1800,label:"۳۰ دقیقه"}],ls=({onDeepScan:n,onQuickScan:o,isScanning:s,autoRefresh:t,autoRefreshInterval:l,onAutoRefreshToggle:c})=>{const[x,a]=g.useState(l),[b,r]=g.useState(!1);g.useEffect(()=>{if(t){a(l);const d=setInterval(()=>{a(m=>m<=1?l:m-1)},1e3);return()=>clearInterval(d)}},[t,l]);const i=d=>{const m=Math.floor(d/60),p=d%60;return`${m}:${p.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("button",{onClick:n,disabled:s,className:`
          flex-1 flex items-center justify-center gap-2 px-6 py-4 rounded-xl font-bold text-lg
          transition-all duration-300 transform
          ${s?"bg-slate-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 hover:shadow-2xl hover:shadow-cyan-500/40 hover:scale-[1.02] active:scale-[0.98]"}
          text-white shadow-xl
        `,children:[e.jsx(z,{className:`w-6 h-6 ${s?"animate-spin":""}`}),e.jsx("span",{children:s?"در حال اسکن عمیق...":"🔍 اسکن عمیق"})]}),e.jsxs("button",{onClick:o,disabled:s,className:`
          flex items-center justify-center gap-2 px-6 py-4 rounded-xl font-semibold
          transition-all duration-200
          ${s?"bg-slate-700 cursor-not-allowed opacity-50":"bg-slate-700/70 hover:bg-slate-700 border border-slate-600"}
          text-white
        `,children:[e.jsx(oe,{className:"w-5 h-5"}),e.jsx("span",{children:"⚡ اسکن سریع"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>r(!b),className:`
            h-full px-4 py-4 rounded-xl font-semibold transition-all duration-200 border
            ${t?"bg-emerald-500/20 border-emerald-500/50 text-emerald-400":"bg-slate-700/70 border-slate-600 text-slate-300 hover:bg-slate-700"}
            flex items-center gap-2
          `,children:[e.jsx(ce,{className:`w-5 h-5 ${t?"animate-spin":""}`}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-xs opacity-70",children:"تازه‌سازی خودکار"}),t?e.jsx("span",{className:"text-sm font-mono",children:i(x)}):e.jsx("span",{className:"text-sm",children:"خاموش"})]})]}),b&&e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-48 bg-slate-800 border border-slate-700 rounded-lg shadow-xl z-10 overflow-hidden",children:[e.jsx("button",{onClick:()=>{c(!1),r(!1)},className:"w-full px-4 py-3 text-right hover:bg-slate-700/50 text-slate-300 transition-colors border-b border-slate-700",children:"❌ خاموش"}),as.map(d=>e.jsx("button",{onClick:()=>{c(!0,d.value),r(!1)},className:`
                  w-full px-4 py-3 text-right hover:bg-slate-700/50 transition-colors
                  ${l===d.value&&t?"text-emerald-400 bg-emerald-500/10":"text-slate-300"}
                `,children:d.label},d.value))]})]})]})},rs=({symbols:n,timeframes:o,onLoad:s})=>{const[t,l]=g.useState([]),[c,x]=g.useState(!1),[a,b]=g.useState(!1),[r,i]=g.useState(""),[d,m]=g.useState(!1);g.useEffect(()=>{const y=localStorage.getItem("scanner_presets");if(y)try{l(JSON.parse(y))}catch(w){console.error("Failed to load presets:",w)}},[]);const p=y=>{localStorage.setItem("scanner_presets",JSON.stringify(y)),l(y)},u=()=>{if(!r.trim())return;const y={id:Date.now().toString(),name:r,symbols:n,timeframes:o,isFavorite:d,createdAt:new Date().toISOString()};p([...t,y]),b(!1),i(""),m(!1)},N=y=>{confirm("آیا مطمئن هستید که می‌خواهید این پیش‌تنظیم را حذف کنید؟")&&p(t.filter(w=>w.id!==y))},j=y=>{p(t.map(w=>w.id===y?{...w,isFavorite:!w.isFavorite}:w))},k=()=>{const y=JSON.stringify(t,null,2),w=new Blob([y],{type:"application/json"}),D=URL.createObjectURL(w),F=document.createElement("a");F.href=D,F.download=`scanner-presets-${Date.now()}.json`,F.click(),URL.revokeObjectURL(D)},U=y=>{var F;const w=(F=y.target.files)==null?void 0:F[0];if(!w)return;const D=new FileReader;D.onload=h=>{var f;try{const S=JSON.parse((f=h.target)==null?void 0:f.result);Array.isArray(S)&&p([...t,...S])}catch{alert("فایل نامعتبر است")}},D.readAsText(w)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>x(!c),className:"flex items-center gap-2 px-4 py-2 bg-slate-700/70 border border-slate-600 text-slate-300 rounded-lg hover:bg-slate-700 transition-colors font-medium",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{children:"پیش‌تنظیم‌ها"})]}),c&&e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-72 bg-slate-800 border border-slate-700 rounded-lg shadow-2xl z-20 overflow-hidden",children:[e.jsxs("button",{onClick:()=>{b(!0),x(!1)},className:"w-full px-4 py-3 text-right hover:bg-slate-700/50 text-slate-300 transition-colors border-b border-slate-700 flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4 text-cyan-400"}),e.jsx("span",{children:"ذخیره تنظیمات فعلی..."})]}),t.length>0&&e.jsx("div",{className:"max-h-64 overflow-y-auto border-b border-slate-700",children:t.sort((y,w)=>(w.isFavorite?1:0)-(y.isFavorite?1:0)).map(y=>e.jsx("div",{className:"px-4 py-3 hover:bg-slate-700/50 transition-colors group",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("button",{onClick:()=>{s(y),x(!1)},className:"flex-1 text-right",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[y.isFavorite&&e.jsx(O,{className:"w-3 h-3 text-yellow-400 fill-yellow-400"}),e.jsx("span",{className:"text-slate-200 font-medium",children:y.name})]}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:[y.symbols.length," نماد • ",y.timeframes.length," بازه"]})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:w=>{w.stopPropagation(),j(y.id)},className:"p-1 hover:bg-slate-600 rounded",children:e.jsx(O,{className:`w-3 h-3 ${y.isFavorite?"text-yellow-400 fill-yellow-400":"text-slate-400"}`})}),e.jsx("button",{onClick:w=>{w.stopPropagation(),N(y.id)},className:"p-1 hover:bg-red-500/20 rounded",children:e.jsx(te,{className:"w-3 h-3 text-red-400"})})]})]})},y.id))}),e.jsxs("div",{className:"p-2 flex gap-2",children:[e.jsxs("button",{onClick:k,className:"flex-1 px-3 py-2 bg-slate-700/50 hover:bg-slate-700 text-slate-300 rounded text-sm flex items-center justify-center gap-1 transition-colors",children:[e.jsx(se,{className:"w-3 h-3"}),e.jsx("span",{children:"خروجی"})]}),e.jsxs("label",{className:"flex-1 px-3 py-2 bg-slate-700/50 hover:bg-slate-700 text-slate-300 rounded text-sm flex items-center justify-center gap-1 transition-colors cursor-pointer",children:[e.jsx(Ee,{className:"w-3 h-3"}),e.jsx("span",{children:"ورودی"}),e.jsx("input",{type:"file",accept:".json",onChange:U,className:"hidden"})]})]})]})]}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-2xl w-full max-w-md p-6 space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"ذخیره پیش‌تنظیم جدید"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"نام پیش‌تنظیم"}),e.jsx("input",{type:"text",value:r,onChange:y=>i(y.target.value),placeholder:"مثال: معاملات روزانه",autoFocus:!0,className:"w-full px-4 py-2 bg-slate-700/50 border border-slate-600/50 rounded-lg text-white placeholder-slate-400 focus:border-cyan-500/50 focus:outline-none"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"makeFavorite",checked:d,onChange:y=>m(y.target.checked),className:"w-4 h-4 accent-yellow-500"}),e.jsx("label",{htmlFor:"makeFavorite",className:"text-sm text-slate-300",children:"علامت‌گذاری به عنوان محبوب"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:u,disabled:!r.trim(),className:"flex-1 px-4 py-2 bg-gradient-to-r from-cyan-500 to-blue-600 text-white rounded-lg font-medium hover:from-cyan-600 hover:to-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"ذخیره"}),e.jsx("button",{onClick:()=>{b(!1),i(""),m(!1)},className:"px-4 py-2 bg-slate-700 text-slate-300 rounded-lg font-medium hover:bg-slate-600 transition-colors",children:"انصراف"})]})]})})]})},ns=({resultsCount:n,scanTime:o,viewMode:s,onViewModeChange:t,sortBy:l,onSortChange:c,directionFilter:x,onDirectionFilterChange:a,searchQuery:b,onSearchChange:r,selectedCount:i,onToggleComparison:d,showComparison:m})=>{const p=[{mode:"list",icon:Fe,label:"لیست"},{mode:"grid",icon:Te,label:"شبکه"},{mode:"chart",icon:ye,label:"نمودار"},{mode:"heatmap",icon:G,label:"نقشه"}],u=[{field:"score",label:"امتیاز"},{field:"symbol",label:"نماد"},{field:"change",label:"تغییر ۲۴ ساعت"},{field:"volume",label:"حجم"}],N=[{filter:"all",label:"همه",color:"slate"},{filter:"BULLISH",label:"صعودی",color:"emerald"},{filter:"BEARISH",label:"نزولی",color:"red"},{filter:"NEUTRAL",label:"خنثی",color:"slate"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gradient-to-r from-emerald-500 to-green-400 animate-pulse"}),e.jsxs("h3",{className:"text-lg font-bold text-white",children:[n," فرصت پیدا شد"]}),o&&e.jsx("span",{className:"text-xs text-slate-400",children:Ge(new Date(o),{addSuffix:!0})})]}),e.jsx("div",{className:"flex items-center gap-2 bg-slate-700/30 p-1 rounded-lg border border-slate-600/30",children:p.map(({mode:j,icon:k,label:U})=>e.jsxs("button",{onClick:()=>t(j),className:`
                flex items-center gap-2 px-4 py-2 rounded-md font-medium text-sm transition-all
                ${s===j?"bg-cyan-500/20 text-cyan-300 shadow-lg shadow-cyan-500/20":"text-slate-400 hover:text-slate-300 hover:bg-slate-700/50"}
              `,"aria-pressed":s===j,children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:U})]},j))})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 md:flex-initial",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-400"}),e.jsxs("select",{value:l,onChange:j=>c(j.target.value),className:"flex-1 md:w-auto px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-lg text-white text-sm focus:border-cyan-500/50 focus:outline-none",children:[e.jsx("option",{value:"",disabled:!0,children:"مرتب‌سازی بر اساس"}),u.map(({field:j,label:k})=>e.jsx("option",{value:j,children:k},j))]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 md:flex-initial",children:[e.jsx(G,{className:"w-4 h-4 text-slate-400"}),e.jsx("select",{value:x,onChange:j=>a(j.target.value),className:"flex-1 md:w-auto px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-lg text-white text-sm focus:border-cyan-500/50 focus:outline-none",children:N.map(({filter:j,label:k})=>e.jsx("option",{value:j,children:k},j))})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx(z,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",value:b,onChange:j=>r(j.target.value),placeholder:"جستجوی نماد...",className:"w-full px-4 py-2 pr-10 bg-slate-700/50 border border-slate-600/50 rounded-lg text-white placeholder-slate-400 text-sm focus:border-cyan-500/50 focus:outline-none"}),b&&e.jsx("button",{onClick:()=>r(""),className:"absolute left-3 top-1/2 -translate-y-1/2 p-1 hover:bg-slate-600/50 rounded transition-colors",children:e.jsx(L,{className:"w-3 h-3 text-slate-400"})})]}),i>0&&e.jsxs("button",{onClick:d,className:`
              flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm transition-all border
              ${m?"bg-purple-500/20 border-purple-500/50 text-purple-300":"bg-slate-700/50 border-slate-600/50 text-slate-300 hover:bg-slate-700"}
            `,children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsxs("span",{children:["مقایسه (",i,")"]})]})]})]})},os=({results:n,selectedSymbols:o,onToggleSelection:s})=>{const t=r=>r.overall_score??r.final_score??r.score??0,l=r=>r.overall_direction??r.direction??"NEUTRAL",c=(r,i)=>r.sample_components&&r.sample_components[i]?r.sample_components[i].score??0:0,x=r=>{if(typeof r.risk_level=="number")return r.risk_level;if(typeof r.risk_level=="string"){const i=r.risk_level.toUpperCase();if(i==="LOW")return 25;if(i==="MEDIUM")return 50;if(i==="HIGH")return 75}return 50},a=r=>r.price??0,b=r=>`${(r*100).toFixed(1)}%`;return e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs("table",{className:"w-full min-w-[1400px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-700/50",children:[e.jsx("th",{className:"text-center py-4 px-2 text-slate-400 font-semibold text-xs",children:e.jsx(Y,{className:"w-4 h-4 mx-auto"})}),e.jsx("th",{className:"text-center py-4 px-3 text-slate-400 font-semibold text-xs",children:"رتبه"}),e.jsx("th",{className:"text-right py-4 px-4 text-slate-400 font-semibold text-sm",children:"نماد / ارز"}),e.jsx("th",{className:"text-center py-4 px-3 text-slate-400 font-semibold text-xs",children:"قیمت (USD)"}),e.jsx("th",{className:"text-center py-4 px-3 text-slate-400 font-semibold text-xs",children:"موفقیت (%)"}),e.jsx("th",{className:"text-center py-4 px-3 text-slate-400 font-semibold text-xs",children:"ریسک (%)"}),e.jsx("th",{className:"text-center py-4 px-3 text-slate-400 font-semibold text-xs",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(de,{className:"w-3 h-3"}),e.jsx("span",{children:"نهنگ‌ها"})]})}),e.jsx("th",{className:"text-center py-4 px-3 text-slate-400 font-semibold text-xs",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(xe,{className:"w-3 h-3"}),e.jsx("span",{children:"SMC"})]})}),e.jsx("th",{className:"text-center py-4 px-3 text-slate-400 font-semibold text-xs",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(Re,{className:"w-3 h-3"}),e.jsx("span",{children:"الیوت"})]})}),e.jsx("th",{className:"text-center py-4 px-3 text-slate-400 font-semibold text-xs",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"}),e.jsx("span",{children:"پرایس اکشن"})]})}),e.jsx("th",{className:"text-center py-4 px-3 text-slate-400 font-semibold text-xs",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(me,{className:"w-3 h-3"}),e.jsx("span",{children:"سطوح ICT"})]})}),e.jsx("th",{className:"text-center py-4 px-4 text-slate-400 font-semibold text-sm",children:"امتیاز نهایی (%)"})]})}),e.jsx("tbody",{children:n.map((r,i)=>{const d=t(r),m=l(r),p=a(r),u=x(r),N=o.has(r.symbol),j=c(r,"whales")||c(r,"whale_activity"),k=c(r,"smc")||c(r,"smart_money"),U=c(r,"elliott")||c(r,"elliott_wave"),y=c(r,"price_action"),w=c(r,"ict")||c(r,"fibonacci");return e.jsxs("tr",{className:`
                  border-b border-slate-800/50 transition-all duration-200 group
                  hover:bg-slate-700/30 cursor-pointer
                  ${N?"bg-purple-500/10":""}
                `,children:[e.jsx("td",{className:"py-3 px-2",children:e.jsx("button",{onClick:D=>{D.stopPropagation(),s(r.symbol)},className:"p-1 hover:bg-slate-600/50 rounded transition-colors",children:N?e.jsx(Ie,{className:"w-4 h-4 text-purple-400"}):e.jsx(Y,{className:"w-4 h-4 text-slate-500 group-hover:text-slate-400"})})}),e.jsx("td",{className:"py-3 px-3",children:e.jsxs("div",{className:`
                    text-center font-bold text-sm ltr-numbers
                    ${i<3?"text-yellow-400":i<10?"text-cyan-400":"text-slate-400"}
                  `,children:["#",i+1]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"font-bold text-white text-base",children:r.symbol}),e.jsx(A,{direction:m,size:"xs"})]})}),e.jsx("td",{className:"py-3 px-3",children:e.jsxs("div",{className:"text-center font-mono text-sm text-white ltr-numbers",children:["$",p>0?p.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"N/A"]})}),e.jsx("td",{className:"py-3 px-3",children:e.jsx("div",{className:`
                    text-center font-mono text-sm font-semibold ltr-numbers
                    ${d>=.7?"text-emerald-400":d>=.4?"text-amber-400":"text-red-400"}
                  `,children:b(d)})}),e.jsx("td",{className:"py-3 px-3",children:e.jsxs("div",{className:`
                    text-center font-mono text-sm font-semibold ltr-numbers
                    ${u<33?"text-emerald-400":u<66?"text-amber-400":"text-red-400"}
                  `,children:[u.toFixed(0),"%"]})}),e.jsx("td",{className:"py-3 px-3",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`
                      w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ltr-numbers
                      ${j>=.7?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":j>=.4?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-slate-700/30 text-slate-400 border border-slate-600/30"}
                    `,children:(j*100).toFixed(0)})})}),e.jsx("td",{className:"py-3 px-3",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`
                      w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ltr-numbers
                      ${k>=.7?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":k>=.4?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-slate-700/30 text-slate-400 border border-slate-600/30"}
                    `,children:(k*100).toFixed(0)})})}),e.jsx("td",{className:"py-3 px-3",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`
                      w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ltr-numbers
                      ${U>=.7?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":U>=.4?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-slate-700/30 text-slate-400 border border-slate-600/30"}
                    `,children:(U*100).toFixed(0)})})}),e.jsx("td",{className:"py-3 px-3",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`
                      w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ltr-numbers
                      ${y>=.7?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":y>=.4?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-slate-700/30 text-slate-400 border border-slate-600/30"}
                    `,children:(y*100).toFixed(0)})})}),e.jsx("td",{className:"py-3 px-3",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`
                      w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ltr-numbers
                      ${w>=.7?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":w>=.4?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-slate-700/30 text-slate-400 border border-slate-600/30"}
                    `,children:(w*100).toFixed(0)})})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:`
                      text-lg font-bold ltr-numbers
                      ${d>=.7?"text-emerald-400":d>=.4?"text-amber-400":"text-red-400"}
                    `,children:b(d)}),e.jsx("div",{className:"h-1.5 rounded-full overflow-hidden bg-slate-700/50",style:{width:"80px"},children:e.jsx("div",{className:`h-full transition-all duration-700 ease-out ${d<.3?"bg-gradient-to-r from-red-500 to-red-600":d<.7?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gradient-to-r from-emerald-500 to-emerald-600"}`,style:{width:`${d*100}%`}})})]})})]},`${r.symbol}-${i}`)})})]})})},cs=({results:n,selectedSymbols:o,onToggleSelection:s})=>{const t=a=>a.overall_score??a.final_score??a.score??0,l=a=>a.overall_direction??a.direction??"NEUTRAL",c=a=>{var b;return a.tf_count??((b=a.timeframes)==null?void 0:b.length)??0},x=a=>{if(a.sample_components){const b=Object.values(a.sample_components),r=b.length;return{active:b.filter(d=>d.score>.5).length,total:r}}return{active:0,total:9}};return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[n.map((a,b)=>{const r=t(a),i=l(a),d=c(a),m=x(a),p=o.has(a.symbol);return e.jsxs("div",{className:`
              relative bg-slate-800/40 backdrop-blur-sm border rounded-xl p-5 space-y-4
              transition-all duration-300 hover:scale-[1.02] hover:shadow-xl cursor-pointer group
              ${p?"border-purple-500/50 bg-purple-500/10 shadow-lg shadow-purple-500/20":"border-slate-700/50 hover:border-slate-600/50"}
            `,style:{animationDelay:`${b*50}ms`,animation:"fadeInUp 0.5s ease-out forwards"},children:[e.jsx("button",{onClick:u=>{u.stopPropagation(),s(a.symbol)},className:"absolute top-3 left-3 p-1 hover:bg-slate-700/50 rounded transition-colors z-10","aria-label":`انتخاب ${a.symbol}`,children:p?e.jsx(we,{className:"w-5 h-5 text-purple-400"}):e.jsx(ke,{className:"w-5 h-5 text-slate-500 group-hover:text-slate-400"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-xl font-bold text-white",children:a.symbol}),e.jsx("div",{className:r>.8?"animate-pulse":"",children:e.jsx(A,{direction:i,size:"sm"})})]}),e.jsx("div",{className:"flex justify-center py-2",children:e.jsx(B,{score:r,size:"lg",showLabel:!0})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[e.jsx("span",{children:"قدرت سیگنال"}),e.jsxs("span",{children:[(r*100).toFixed(0),"%"]})]}),e.jsx("div",{className:"h-2 rounded-full overflow-hidden bg-slate-700/50",children:e.jsx("div",{className:`h-full transition-all duration-700 ease-out ${r<.3?"bg-gradient-to-r from-red-500 to-red-600":r<.7?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gradient-to-r from-emerald-500 to-emerald-600"}`,style:{width:`${r*100}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-center",children:[e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-3 border border-slate-700/30",children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"سیگنال‌ها"}),e.jsxs("div",{className:"text-lg font-bold text-slate-200",children:[m.active,"/",m.total]})]}),e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-3 border border-slate-700/30",children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"بازه‌ها"}),e.jsx("div",{className:"text-lg font-bold text-slate-200",children:d})]})]}),a.timeframes&&a.timeframes.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 justify-center",children:a.timeframes.slice(0,4).map(u=>e.jsx("span",{className:`
                      px-2 py-1 rounded text-xs font-mono font-semibold border
                      ${i==="BULLISH"?"bg-emerald-500/20 border-emerald-500/30 text-emerald-300":i==="BEARISH"?"bg-red-500/20 border-red-500/30 text-red-300":"bg-slate-600/20 border-slate-500/30 text-slate-400"}
                    `,children:u},u))}),e.jsxs("button",{onClick:()=>console.log("Open details for",a.symbol),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-gradient-to-r from-cyan-500/20 to-blue-500/20 hover:from-cyan-500/30 hover:to-blue-500/30 border border-cyan-500/30 text-cyan-400 rounded-lg font-medium transition-all hover:scale-105",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{children:"مشاهده جزئیات"})]})]},`${a.symbol}-${b}`)}),e.jsx("style",{jsx:!0,children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]})},is=({results:n})=>{const o=t=>t.overall_score??t.final_score??t.score??0,s=t=>t.overall_direction??t.direction??"NEUTRAL";return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"text-sm text-slate-400 text-center py-4 bg-slate-900/30 rounded-lg border border-slate-700/30",children:"💡 نمای نمودار: نمایش بصری امتیازات و روندها"}),e.jsx("div",{className:"space-y-4",children:n.map((t,l)=>{var a;const c=o(t),x=s(t);return e.jsx("div",{className:"bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 rounded-xl p-4 hover:border-slate-600/50 transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-32 flex flex-col gap-2",children:[e.jsx("div",{className:"font-bold text-white text-lg",children:t.symbol}),e.jsx(A,{direction:x,size:"sm"})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(B,{score:c,size:"sm",showLabel:!1})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"flex justify-between text-xs text-slate-400",children:e.jsxs("span",{children:["امتیاز: ",(c*100).toFixed(0),"%"]})}),e.jsxs("div",{className:"relative h-8 rounded-lg overflow-hidden bg-slate-900/50 border border-slate-700/30",children:[e.jsx("div",{className:`
                        absolute inset-y-0 right-0 transition-all duration-1000 ease-out
                        ${c<.3?"bg-gradient-to-l from-red-500 to-red-600":c<.7?"bg-gradient-to-l from-amber-500 to-amber-600":"bg-gradient-to-l from-emerald-500 to-emerald-600"}
                      `,style:{width:`${c*100}%`,animationDelay:`${l*100}ms`}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-white font-bold text-sm drop-shadow-lg",children:[(c*100).toFixed(0),"%"]})})]})]}),e.jsx("div",{className:"flex gap-2",children:(a=t.timeframes)==null?void 0:a.slice(0,3).map(b=>e.jsx("span",{className:`
                        px-2 py-1 rounded text-xs font-mono border
                        ${x==="BULLISH"?"bg-emerald-500/20 border-emerald-500/30 text-emerald-300":x==="BEARISH"?"bg-red-500/20 border-red-500/30 text-red-300":"bg-slate-600/20 border-slate-500/30 text-slate-400"}
                      `,children:b},b))}),e.jsx("button",{onClick:()=>console.log("Open details for",t.symbol),className:"px-4 py-2 bg-cyan-500/20 hover:bg-cyan-500/30 text-cyan-400 border border-cyan-500/30 rounded-lg text-sm font-medium transition-all whitespace-nowrap",children:"جزئیات"})]})},`${t.symbol}-${l}`)})})]})},ds=({results:n})=>{const[o,s]=g.useState(null),t=r=>r.overall_score??r.final_score??r.score??0,l=r=>r.overall_direction??r.direction??"NEUTRAL",c=r=>r<.3?"bg-red-500":r<.4?"bg-red-400":r<.5?"bg-orange-400":r<.6?"bg-yellow-400":r<.7?"bg-lime-400":r<.8?"bg-emerald-400":"bg-emerald-500",x=r=>Math.max(.3,Math.min(1,r+.2)),a=n.length,b=Math.ceil(Math.sqrt(a));return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4 bg-slate-900/30 rounded-lg border border-slate-700/30",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"🗺️ نقشه حرارتی بازار"}),e.jsx("p",{className:"text-sm text-slate-400",children:"اندازه مربع = امتیاز | رنگ = جهت | شدت رنگ = قدرت سیگنال"})]}),e.jsx("div",{className:"bg-slate-900/30 rounded-xl border border-slate-700/30 p-6 overflow-hidden",style:{display:"grid",gridTemplateColumns:`repeat(${b}, 1fr)`,gap:"8px",minHeight:"400px"},children:n.map(r=>{const i=t(r),d=l(r),m=Math.max(60,i*150),p=o===r.symbol;return e.jsxs("div",{className:"flex items-center justify-center relative",onMouseEnter:()=>s(r.symbol),onMouseLeave:()=>s(null),children:[e.jsxs("div",{className:`
                  ${c(i)} rounded-lg flex flex-col items-center justify-center
                  transition-all duration-300 cursor-pointer
                  ${p?"scale-110 shadow-2xl z-10":"hover:scale-105"}
                `,style:{width:`${m}px`,height:`${m}px`,opacity:x(i)},children:[e.jsx("span",{className:"text-white font-bold text-sm drop-shadow-lg",children:r.symbol.replace("USDT","")}),e.jsxs("span",{className:"text-white text-xs font-semibold mt-1 drop-shadow-lg",children:[(i*100).toFixed(0),"%"]}),d==="BULLISH"&&e.jsx("span",{className:"text-white text-lg",children:"↑"}),d==="BEARISH"&&e.jsx("span",{className:"text-white text-lg",children:"↓"})]}),p&&e.jsxs("div",{className:"absolute top-full mt-2 left-1/2 -translate-x-1/2 z-20 w-48 p-3 bg-slate-800 border border-slate-700 rounded-lg shadow-2xl text-sm",children:[e.jsx("div",{className:"font-bold text-white mb-1",children:r.symbol}),e.jsxs("div",{className:"text-slate-300 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"امتیاز:"}),e.jsxs("span",{className:"font-mono",children:[(i*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"جهت:"}),e.jsx("span",{className:d==="BULLISH"?"text-emerald-400":d==="BEARISH"?"text-red-400":"text-slate-400",children:d==="BULLISH"?"صعودی":d==="BEARISH"?"نزولی":"خنثی"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"بازه‌ها:"}),e.jsx("span",{className:"font-mono",children:r.tf_count||0})]})]})]})]},r.symbol)})}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-6 p-4 bg-slate-900/30 rounded-lg border border-slate-700/30",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"جهت:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded"}),e.jsx("span",{className:"text-xs text-slate-300",children:"صعودی"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),e.jsx("span",{className:"text-xs text-slate-300",children:"نزولی"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded"}),e.jsx("span",{className:"text-xs text-slate-300",children:"خنثی"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"قدرت:"}),e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx("div",{className:"w-8 h-3 bg-emerald-500 opacity-30 rounded"}),e.jsx("div",{className:"w-8 h-3 bg-emerald-500 opacity-50 rounded"}),e.jsx("div",{className:"w-8 h-3 bg-emerald-500 opacity-70 rounded"}),e.jsx("div",{className:"w-8 h-3 bg-emerald-500 opacity-100 rounded"}),e.jsx("span",{className:"text-xs text-slate-300 mr-2",children:"ضعیف → قوی"})]})]})]})]})},xs=({results:n})=>{const[o,s]=g.useState(!1),[t,l]=g.useState(!1),c=d=>d.overall_score??d.final_score??d.score??0,x=d=>d.overall_direction??d.direction??"NEUTRAL",a=()=>{const d=["نماد","امتیاز","جهت","تعداد بازه‌های زمانی","بازه‌ها"],m=n.map(k=>[k.symbol,c(k).toFixed(2),x(k),k.tf_count||0,(k.timeframes||[]).join("; ")]),p=[d.join(","),...m.map(k=>k.join(","))].join(`
`),u=new Blob(["\uFEFF"+p],{type:"text/csv;charset=utf-8;"}),N=URL.createObjectURL(u),j=document.createElement("a");j.href=N,j.download=`scanner-results-${Date.now()}.csv`,j.click(),URL.revokeObjectURL(N),s(!1)},b=()=>{const d=n.map(j=>({symbol:j.symbol,score:c(j),direction:x(j),timeframes:j.timeframes||[],tf_count:j.tf_count||0,sample_components:j.sample_components})),m=JSON.stringify(d,null,2),p=new Blob([m],{type:"application/json"}),u=URL.createObjectURL(p),N=document.createElement("a");N.href=u,N.download=`scanner-results-${Date.now()}.json`,N.click(),URL.revokeObjectURL(u),s(!1)},r=async()=>{const d=n.map(m=>`${m.symbol}: ${(c(m)*100).toFixed(0)}% - ${x(m)}`).join(`
`);try{await navigator.clipboard.writeText(d),l(!0),setTimeout(()=>l(!1),2e3)}catch(m){console.error("Failed to copy:",m)}s(!1)},i=async()=>{const d=`🔍 نتایج اسکن بازار

`+n.slice(0,5).map(m=>`${m.symbol}: ${(c(m)*100).toFixed(0)}% - ${x(m)}`).join(`
`)+(n.length>5?`

... و ${n.length-5} نماد دیگر`:"");if(navigator.share)try{await navigator.share({title:"نتایج اسکن بازار",text:d})}catch{console.log("Share cancelled or failed")}else await r();s(!1)};return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>s(!o),disabled:n.length===0,className:"flex items-center gap-2 px-4 py-2 bg-slate-700/70 border border-slate-600 text-slate-300 rounded-lg hover:bg-slate-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{children:"خروجی"})]}),o&&e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-56 bg-slate-800 border border-slate-700 rounded-lg shadow-2xl z-20 overflow-hidden",children:[e.jsxs("button",{onClick:a,className:"w-full px-4 py-3 text-right hover:bg-slate-700/50 text-slate-300 transition-colors flex items-center gap-3 border-b border-slate-700",children:[e.jsx(q,{className:"w-4 h-4 text-emerald-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:"خروجی CSV"}),e.jsx("div",{className:"text-xs text-slate-400",children:"برای Excel و Google Sheets"})]})]}),e.jsxs("button",{onClick:b,className:"w-full px-4 py-3 text-right hover:bg-slate-700/50 text-slate-300 transition-colors flex items-center gap-3 border-b border-slate-700",children:[e.jsx(q,{className:"w-4 h-4 text-cyan-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:"خروجی JSON"}),e.jsx("div",{className:"text-xs text-slate-400",children:"فرمت داده ساختاریافته"})]})]}),e.jsxs("button",{onClick:r,className:"w-full px-4 py-3 text-right hover:bg-slate-700/50 text-slate-300 transition-colors flex items-center gap-3 border-b border-slate-700",children:[t?e.jsx(je,{className:"w-4 h-4 text-green-400"}):e.jsx(Se,{className:"w-4 h-4 text-blue-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:t?"کپی شد!":"کپی متن"}),e.jsx("div",{className:"text-xs text-slate-400",children:"کپی به کلیپ‌بورد"})]})]}),e.jsxs("button",{onClick:i,className:"w-full px-4 py-3 text-right hover:bg-slate-700/50 text-slate-300 transition-colors flex items-center gap-3",children:[e.jsx(Le,{className:"w-4 h-4 text-purple-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:"اشتراک‌گذاری"}),e.jsx("div",{className:"text-xs text-slate-400",children:"ارسال به دیگران"})]})]})]})]})},ms=({symbols:n,results:o,onClose:s})=>{const t=a=>a.overall_score??a.final_score??a.score??0,l=a=>a.overall_direction??a.direction??"NEUTRAL",c=a=>{if(a.sample_components){const b=Object.values(a.sample_components),r=b.length;return{active:b.filter(d=>d.score>.5).length,total:r}}return{active:0,total:9}},x=o.reduce((a,b)=>t(b)>t(a)?b:a,o[0]);return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:"📊 مقایسه نمادها"}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:["مقایسه جانبه ",o.length," نماد انتخاب شده"]})]}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-700 rounded-lg transition-colors","aria-label":"بستن",children:e.jsx(L,{className:"w-6 h-6 text-slate-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-cyan-500/10 to-blue-500/10 border border-cyan-500/30 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(R,{className:"w-5 h-5 text-cyan-400"}),e.jsx("span",{className:"font-semibold text-cyan-300",children:"بهترین فرصت:"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-2xl font-bold text-white",children:x==null?void 0:x.symbol}),e.jsx(A,{direction:l(x),size:"md"}),e.jsxs("span",{className:"text-cyan-400 text-lg font-mono",children:[(t(x)*100).toFixed(0),"%"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("th",{className:"text-right py-3 px-4 text-slate-400 font-semibold text-sm",children:"معیار"}),o.map(a=>e.jsx("th",{className:"text-center py-3 px-4 text-slate-400 font-semibold text-sm",children:a.symbol},a.symbol))]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-slate-800",children:[e.jsx("td",{className:"py-4 px-4 text-slate-300 font-medium",children:"امتیاز نهایی"}),o.map(a=>e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(B,{score:t(a),size:"sm",showLabel:!1})})},a.symbol))]}),e.jsxs("tr",{className:"border-b border-slate-800",children:[e.jsx("td",{className:"py-4 px-4 text-slate-300 font-medium",children:"جهت"}),o.map(a=>e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(A,{direction:l(a),size:"sm"})})},a.symbol))]}),e.jsxs("tr",{className:"border-b border-slate-800",children:[e.jsx("td",{className:"py-4 px-4 text-slate-300 font-medium",children:"سیگنال‌های فعال"}),o.map(a=>{const{active:b,total:r}=c(a);return e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsxs("span",{className:"text-slate-200 font-mono font-semibold",children:[b,"/",r]})},a.symbol)})]}),e.jsxs("tr",{className:"border-b border-slate-800",children:[e.jsx("td",{className:"py-4 px-4 text-slate-300 font-medium",children:"تعداد بازه‌ها"}),o.map(a=>{var b;return e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsx("span",{className:"text-slate-200 font-mono font-semibold",children:a.tf_count||((b=a.timeframes)==null?void 0:b.length)||0})},a.symbol)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-4 px-4 text-slate-300 font-medium",children:"توصیه"}),o.map(a=>{const b=t(a),r=a.symbol===x.symbol;return e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r&&e.jsx("span",{className:"text-xs font-semibold text-cyan-400 bg-cyan-500/20 px-2 py-1 rounded",children:"⭐ بهترین"}),b>=.7?e.jsx("span",{className:"text-xs text-emerald-400",children:"✓ قوی"}):b>=.5?e.jsx("span",{className:"text-xs text-amber-400",children:"~ متوسط"}):e.jsx("span",{className:"text-xs text-red-400",children:"✗ ضعیف"})]})},a.symbol)})]})]})]})}),e.jsxs("div",{className:"bg-slate-900/50 border border-slate-700/50 rounded-xl p-4 space-y-3",children:[e.jsx("h3",{className:"font-semibold text-white flex items-center gap-2",children:"💡 تحلیل مقایسه‌ای"}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-white",children:x==null?void 0:x.symbol})," بالاترین امتیاز (",(t(x)*100).toFixed(0),"%) را دارد و بهترین فرصت معاملاتی است."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400",children:"•"}),e.jsxs("span",{children:[o.filter(a=>l(a)==="BULLISH").length," نماد روند صعودی و"," ",o.filter(a=>l(a)==="BEARISH").length," نماد روند نزولی دارند."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400",children:"•"}),e.jsx("span",{children:"توصیه می‌شود ابتدا نمادهای با امتیاز بالاتر از ۷۰٪ را بررسی کنید."})]})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-6 py-2 bg-slate-700 text-slate-300 rounded-lg font-medium hover:bg-slate-600 transition-colors",children:"بستن"}),e.jsxs("button",{onClick:()=>console.log("Open details for best:",x==null?void 0:x.symbol),className:"px-6 py-2 bg-gradient-to-r from-cyan-500 to-blue-600 text-white rounded-lg font-medium hover:from-cyan-600 hover:to-blue-700 transition-all",children:["جزئیات ",x==null?void 0:x.symbol]})]})]})})},W=[{keys:["↑","↓"],description:"پیمایش بین نتایج",category:"پیمایش"},{keys:["Enter"],description:"باز کردن جزئیات نماد",category:"پیمایش"},{keys:["Space"],description:"انتخاب/عدم انتخاب نماد",category:"پیمایش"},{keys:["Esc"],description:"پاک کردن فیلترها / بستن مودال",category:"پیمایش"},{keys:["Tab"],description:"جابجایی بین کنترل‌ها",category:"پیمایش"},{keys:["Ctrl","S"],description:"اجرای اسکن عمیق",category:"عملیات"},{keys:["Ctrl","Q"],description:"اجرای اسکن سریع",category:"عملیات"},{keys:["Ctrl","E"],description:"خروجی گرفتن از نتایج",category:"عملیات"},{keys:["Ctrl","F"],description:"فوکوس روی جستجو",category:"عملیات"},{keys:["Ctrl","A"],description:"انتخاب همه نتایج",category:"عملیات"},{keys:["Ctrl","D"],description:"حذف انتخاب همه",category:"عملیات"},{keys:["1"],description:"نمای لیست",category:"نماها"},{keys:["2"],description:"نمای شبکه",category:"نماها"},{keys:["3"],description:"نمای نمودار",category:"نماها"},{keys:["F"],description:"باز کردن فیلترهای پیشرفته",category:"فیلترها"},{keys:["B"],description:"فقط نمادهای صعودی",category:"فیلترها"},{keys:["N"],description:"فقط نمادهای نزولی",category:"فیلترها"},{keys:["R"],description:"بازنشانی فیلترها",category:"فیلترها"},{keys:["?"],description:"نمایش این راهنما",category:"راهنما"}],hs=({isOpen:n,onClose:o})=>{if(!n)return null;const s=Array.from(new Set(W.map(t=>t.category)));return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:o,children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl w-full max-w-3xl max-h-[85vh] overflow-hidden flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center",children:e.jsx(Ue,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"میانبرهای صفحه‌کلید"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"برای افزایش سرعت کار با اسکنر از این میانبرها استفاده کنید"})]})]}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-slate-700 rounded-lg transition-colors","aria-label":"بستن",children:e.jsx(L,{className:"w-6 h-6 text-slate-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:s.map(t=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-bold text-cyan-400 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-cyan-500 to-blue-500 rounded-full"}),t]}),e.jsx("div",{className:"space-y-2",children:W.filter(l=>l.category===t).map((l,c)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900/50 rounded-lg border border-slate-700/30 hover:border-slate-600/50 transition-colors",children:[e.jsx("span",{className:"text-slate-300 text-sm",children:l.description}),e.jsx("div",{className:"flex items-center gap-1",children:l.keys.map((x,a)=>e.jsxs(Z.Fragment,{children:[e.jsx("kbd",{className:"px-2 py-1 bg-slate-700 border border-slate-600 rounded text-xs font-mono text-white shadow-sm min-w-[2rem] text-center",children:x}),a<l.keys.length-1&&e.jsx("span",{className:"text-slate-500 text-xs",children:"+"})]},a))})]},c))})]},t))}),e.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-purple-500/10 to-pink-500/10 border border-purple-500/30 rounded-xl",children:[e.jsx("h4",{className:"font-semibold text-purple-300 mb-2 flex items-center gap-2",children:"💡 نکات"}),e.jsxs("ul",{className:"space-y-1 text-sm text-slate-300",children:[e.jsx("li",{children:"• برای استفاده از میانبرها، ابتدا مطمئن شوید فوکوس روی صفحه است"}),e.jsx("li",{children:"• در نمای لیست، می‌توانید با فلش‌ها بین نتایج حرکت کنید"}),e.jsx("li",{children:"• برای انتخاب چند نماد، Space را روی هر کدام بزنید"}),e.jsx("li",{children:'• Ctrl+S مانند کلیک روی دکمه "اسکن عمیق" عمل می‌کند'})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-slate-700 flex items-center justify-between bg-slate-900/50",children:[e.jsxs("div",{className:"text-xs text-slate-400",children:["برای چاپ این راهنما: ",e.jsx("kbd",{className:"px-2 py-1 bg-slate-700 rounded text-white",children:"Ctrl+P"})]}),e.jsx("button",{onClick:o,className:"px-6 py-2 bg-gradient-to-r from-cyan-500 to-blue-600 text-white rounded-lg font-medium hover:from-cyan-600 hover:to-blue-700 transition-all",children:"فهمیدم!"})]})]})})},bs=({isOpen:n,onClose:o,onRestore:s})=>{const[t,l]=g.useState([]);g.useEffect(()=>{const i=localStorage.getItem("scanner_session_history");if(i)try{l(JSON.parse(i))}catch(d){console.error("Failed to load session history:",d)}},[n]);const c=i=>{const d=i.slice(0,50);localStorage.setItem("scanner_session_history",JSON.stringify(d)),l(d)},x=i=>{const d=t.map(m=>m.id===i?{...m,isPinned:!m.isPinned}:m);d.sort((m,p)=>(p.isPinned?1:0)-(m.isPinned?1:0)),c(d)},a=i=>{confirm("آیا مطمئن هستید که می‌خواهید این جلسه را حذف کنید؟")&&c(t.filter(d=>d.id!==i))},b=()=>{confirm("آیا مطمئن هستید که می‌خواهید تمام تاریخچه را پاک کنید؟")&&(localStorage.removeItem("scanner_session_history"),l([]))},r=i=>{const d=new Date,m=new Date(i),p=d.getTime()-m.getTime(),u=Math.floor(p/6e4);if(u<1)return"همین الان";if(u<60)return`${u} دقیقه پیش`;const N=Math.floor(u/60);return N<24?`${N} ساعت پیش`:`${Math.floor(N/24)} روز پیش`};return n?e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:o,children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[85vh] overflow-hidden flex flex-col",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center",children:e.jsx(J,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"تاریخچه اسکن‌ها"}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:[t.length," جلسه ذخیره شده"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.length>0&&e.jsx("button",{onClick:b,className:"px-3 py-2 text-sm bg-red-500/20 border border-red-500/30 text-red-400 rounded-lg hover:bg-red-500/30 transition-colors",children:"پاک کردن همه"}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-slate-700 rounded-lg transition-colors","aria-label":"بستن",children:e.jsx(L,{className:"w-6 h-6 text-slate-400"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(J,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-400 mb-2",children:"هنوز هیچ اسکنی انجام نشده"}),e.jsx("p",{className:"text-sm text-slate-500",children:"اسکن‌های شما به صورت خودکار در اینجا ذخیره می‌شوند"})]}):e.jsx("div",{className:"space-y-3",children:t.map(i=>e.jsx("div",{className:`
                    bg-slate-900/50 border rounded-xl p-4 transition-all hover:border-slate-600/50
                    ${i.isPinned?"border-yellow-500/30 bg-yellow-500/5":"border-slate-700/50"}
                  `,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.isPinned&&e.jsx(Q,{className:"w-4 h-4 text-yellow-400 fill-yellow-400"}),e.jsx(ee,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-sm text-slate-400",children:r(i.timestamp)}),e.jsxs("span",{className:"text-xs text-slate-500",children:["• ",new Date(i.timestamp).toLocaleString("fa-IR")]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"نمادها:"}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[i.symbols.slice(0,5).map(d=>e.jsx("span",{className:"px-2 py-0.5 bg-slate-700/50 text-slate-300 rounded text-xs",children:d},d)),i.symbols.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-slate-400 text-xs",children:["+",i.symbols.length-5]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"بازه‌ها:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:i.timeframes.map(d=>e.jsx("span",{className:"px-2 py-0.5 bg-slate-700/50 text-slate-300 rounded text-xs font-mono",children:d},d))})]})]}),i.topResults.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-700/50",children:[e.jsxs("span",{className:"text-xs text-slate-400 mb-2 block",children:["نتایج برتر (",i.resultsCount," فرصت):"]}),e.jsx("div",{className:"flex gap-3",children:i.topResults.map(d=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"text-slate-300 font-medium",children:d.symbol}),e.jsxs("span",{className:"text-emerald-400 font-mono",children:[(d.score*100).toFixed(0),"%"]})]},d.symbol))})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>x(i.id),className:`p-2 rounded-lg transition-colors ${i.isPinned?"bg-yellow-500/20 text-yellow-400 hover:bg-yellow-500/30":"bg-slate-700/50 text-slate-400 hover:bg-slate-700"}`,title:i.isPinned?"حذف پین":"پین کردن",children:e.jsx(Q,{className:`w-4 h-4 ${i.isPinned?"fill-current":""}`})}),e.jsx("button",{onClick:()=>{s(i),o()},className:"px-3 py-2 bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-lg text-sm font-medium hover:bg-cyan-500/30 transition-colors whitespace-nowrap",children:"بازیابی"}),e.jsx("button",{onClick:()=>a(i.id),className:"p-2 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition-colors",title:"حذف",children:e.jsx(te,{className:"w-4 h-4"})})]})]})},i.id))})}),e.jsx("div",{className:"p-4 border-t border-slate-700 bg-slate-900/50",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[e.jsx("span",{children:"تاریخچه به صورت خودکار ذخیره می‌شود (حداکثر ۵۰ جلسه)"}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-slate-700 text-slate-300 rounded-lg font-medium hover:bg-slate-600 transition-colors",children:"بستن"})]})})]})}):null},ps=(n,o,s)=>{const t=localStorage.getItem("scanner_session_history"),l=t?JSON.parse(t):[],c={id:Date.now().toString(),timestamp:new Date().toISOString(),symbols:n,timeframes:o,resultsCount:s.length,topResults:s.sort((x,a)=>(a.score||a.final_score||0)-(x.score||x.final_score||0)).slice(0,3).map(x=>({symbol:x.symbol,score:x.score||x.final_score||0})),isPinned:!1};l.unshift(c),localStorage.setItem("scanner_session_history",JSON.stringify(l.slice(0,50)))},ys=()=>{const n=he(),o=g.useRef(null),[s,t]=g.useState({symbols:n.symbols,timeframes:n.timeframes,isScanning:!1,results:[],error:null,hasScanned:!1,scanTime:null,viewMode:"list",sortBy:"score",sortDirection:"desc",directionFilter:"all",searchQuery:"",advancedFilters:{scoreMin:0,scoreMax:1,priceChange:"any",volumeMin:0,signalCountMin:0,tfAgreement:"any"},showAdvancedFilters:!1,autoRefresh:!1,autoRefreshInterval:300,selectedSymbols:new Set,showComparison:!1}),[l,c]=g.useState(!1),[x,a]=g.useState(!1),b=g.useCallback(h=>h.overall_score??h.final_score??h.score??0,[]),r=g.useCallback(h=>h.overall_direction??h.direction??"NEUTRAL",[]),i=g.useCallback(async(h=!1)=>{t(f=>({...f,isScanning:!0,error:null,hasScanned:!0}));try{if(s.symbols.length===0)throw new Error("لطفاً حداقل یک نماد انتخاب کنید");if(s.timeframes.length===0)throw new Error("لطفاً حداقل یک بازه زمانی انتخاب کنید");const f={symbols:s.symbols,timeframes:s.timeframes,weights:n.weights,rules:{min_score:n.rules.any_tf,min_confidence:n.rules.majority_tf,max_risk_level:n.rules.mode==="aggressive"?"HIGH":"MEDIUM",quick_scan:h}};console.log("Scanner request:",f);const S=await be.post("/api/scanner/run",f),C=S.results||S.result||[];t(M=>({...M,results:C,error:null,isScanning:!1,scanTime:new Date().toISOString()})),ps(s.symbols,s.timeframes,C)}catch(f){console.error("Scanner error:",f),t(S=>({...S,error:f.message||"خطا در اسکن بازار",results:[],isScanning:!1}))}},[s.symbols,s.timeframes,n.weights,n.rules]);g.useEffect(()=>{if(s.autoRefresh&&s.hasScanned)return o.current&&clearInterval(o.current),o.current=setInterval(()=>{console.log("Auto-refresh triggered"),i(!0)},s.autoRefreshInterval*1e3),()=>{o.current&&clearInterval(o.current)}},[s.autoRefresh,s.autoRefreshInterval,s.hasScanned,i]);const d=g.useMemo(()=>{let h=[...s.results];s.searchQuery&&(h=h.filter(T=>T.symbol.toLowerCase().includes(s.searchQuery.toLowerCase()))),s.directionFilter!=="all"&&(h=h.filter(T=>r(T)===s.directionFilter));const{scoreMin:f,scoreMax:S,signalCountMin:C,tfAgreement:M,priceChange:$}=s.advancedFilters;return h=h.filter(T=>{const P=b(T);return!(P<f||P>S||(T.sample_components?Object.keys(T.sample_components).length:0)<C||M==="full"&&T.tf_count!==s.timeframes.length||M==="majority"&&T.tf_count&&T.tf_count<Math.ceil(s.timeframes.length/2))}),h},[s.results,s.searchQuery,s.directionFilter,s.advancedFilters,s.timeframes.length,b,r]),m=g.useMemo(()=>{const h=[...d];return h.sort((f,S)=>{let C,M;switch(s.sortBy){case"score":C=b(f),M=b(S);break;case"symbol":C=f.symbol,M=S.symbol;break;case"change":C=0,M=0;break;case"volume":C=0,M=0;break;default:return 0}const $=typeof C=="string"?C.localeCompare(M):C-M;return s.sortDirection==="asc"?$:-$}),h},[d,s.sortBy,s.sortDirection,b]),p=g.useCallback(h=>{t(f=>({...f,symbols:h}))},[]),u=g.useCallback(h=>{t(f=>({...f,timeframes:h}))},[]),N=g.useCallback(h=>{t(f=>({...f,viewMode:h}))},[]),j=g.useCallback(h=>{t(f=>({...f,sortBy:h,sortDirection:f.sortBy===h&&f.sortDirection==="desc"?"asc":"desc"}))},[]),k=g.useCallback(h=>{t(f=>({...f,directionFilter:h}))},[]),U=g.useCallback(h=>{t(f=>({...f,searchQuery:h}))},[]),y=g.useCallback(h=>{t(f=>({...f,advancedFilters:{...f.advancedFilters,...h}}))},[]),w=g.useCallback((h,f)=>{t(S=>({...S,autoRefresh:h,autoRefreshInterval:f??S.autoRefreshInterval}))},[]),D=g.useCallback(h=>{t(f=>{const S=new Set(f.selectedSymbols);if(S.has(h))S.delete(h);else{if(S.size>=4)return f;S.add(h)}return{...f,selectedSymbols:S}})},[]);g.useCallback(()=>{t(h=>({...h,selectedSymbols:new Set}))},[]);const F=g.useCallback(()=>{t(h=>({...h,showComparison:!h.showComparison}))},[]);return Je([{key:"s",ctrlKey:!0,handler:h=>{h.preventDefault(),s.isScanning||i(!1)},description:"اجرای اسکن عمیق"},{key:"q",ctrlKey:!0,handler:()=>{s.isScanning||i(!0)},description:"اجرای اسکن سریع"},{key:"1",handler:()=>N("list"),description:"نمای لیست"},{key:"2",handler:()=>N("grid"),description:"نمای شبکه"},{key:"3",handler:()=>N("chart"),description:"نمای نمودار"},{key:"4",handler:()=>N("heatmap"),description:"نقشه حرارتی"},{key:"f",handler:()=>t(h=>({...h,showAdvancedFilters:!h.showAdvancedFilters})),description:"فیلترهای پیشرفته"},{key:"b",handler:()=>k("BULLISH"),description:"فقط صعودی"},{key:"n",handler:()=>k("BEARISH"),description:"فقط نزولی"},{key:"r",handler:()=>k("all"),description:"بازنشانی فیلتر جهت"},{key:"?",handler:()=>c(!0),description:"نمایش راهنمای میانبرها"},{key:"Escape",handler:()=>{l?c(!1):s.showComparison&&F()},description:"بستن مودال‌ها"}],!l&&!s.showComparison),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-4 md:p-6",children:e.jsxs("div",{className:"max-w-[1600px] mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-white mb-2 flex items-center gap-3",children:["🔍 اسکنر پیشرفته بازار",e.jsxs("button",{onClick:()=>c(!0),className:"text-sm px-3 py-1 bg-purple-500/20 border border-purple-500/30 text-purple-300 rounded-lg hover:bg-purple-500/30 transition-colors flex items-center gap-1",title:"میانبرهای صفحه‌کلید",children:[e.jsx("span",{children:"?"}),e.jsx("span",{className:"hidden sm:inline",children:"میانبرها"})]})]}),e.jsx("p",{className:"text-slate-400",children:"اسکن چند بازه زمانی با تحلیل ترکیبی ۹ الگوریتم حرفه‌ای"})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-4 py-2 bg-slate-700/70 border border-slate-600 text-slate-300 rounded-lg hover:bg-slate-700 transition-colors font-medium",children:[e.jsx("span",{children:"📜"}),e.jsx("span",{className:"hidden sm:inline",children:"تاریخچه"})]}),e.jsx(xs,{results:m}),e.jsx(rs,{symbols:s.symbols,timeframes:s.timeframes,onLoad:h=>{t(f=>({...f,symbols:h.symbols,timeframes:h.timeframes}))}})]})]}),e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-xl rounded-2xl border border-slate-700/50 p-6 space-y-6",children:[e.jsx(Ye,{onSelectGroup:p}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(We,{symbols:s.symbols,onChange:p,disabled:s.isScanning}),e.jsx(ss,{timeframes:s.timeframes,onChange:u,disabled:s.isScanning})]}),e.jsx(ts,{filters:s.advancedFilters,onChange:y,isExpanded:s.showAdvancedFilters,onToggle:()=>t(h=>({...h,showAdvancedFilters:!h.showAdvancedFilters}))}),e.jsx(ls,{onDeepScan:()=>i(!1),onQuickScan:()=>i(!0),isScanning:s.isScanning,autoRefresh:s.autoRefresh,autoRefreshInterval:s.autoRefreshInterval,onAutoRefreshToggle:w})]}),e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-xl rounded-2xl border border-slate-700/50 p-6 space-y-6",children:[e.jsx(ns,{resultsCount:m.length,scanTime:s.scanTime,viewMode:s.viewMode,onViewModeChange:N,sortBy:s.sortBy,onSortChange:j,directionFilter:s.directionFilter,onDirectionFilterChange:k,searchQuery:s.searchQuery,onSearchChange:U,selectedCount:s.selectedSymbols.size,onToggleComparison:F,showComparison:s.showComparison}),s.isScanning&&e.jsx(pe,{message:"در حال تحلیل نمادها..."}),!s.isScanning&&s.error&&e.jsx(fe,{message:s.error,onRetry:()=>i(!1)}),!s.isScanning&&!s.error&&!s.hasScanned&&e.jsx(X,{icon:"📊",title:"آماده برای اسکن",description:"نمادها و بازه‌های زمانی را انتخاب کنید و دکمه اسکن را بزنید"}),!s.isScanning&&!s.error&&s.hasScanned&&m.length===0&&e.jsx(X,{icon:"🔍",title:"نتیجه‌ای یافت نشد",description:"با معیارهای انتخاب شده، فرصتی شناسایی نشد. فیلترها را تغییر دهید یا نمادهای بیشتری امتحان کنید"}),!s.isScanning&&!s.error&&m.length>0&&e.jsxs(e.Fragment,{children:[s.viewMode==="list"&&e.jsx(os,{results:m,selectedSymbols:s.selectedSymbols,onToggleSelection:D}),s.viewMode==="grid"&&e.jsx(cs,{results:m,selectedSymbols:s.selectedSymbols,onToggleSelection:D}),s.viewMode==="chart"&&e.jsx(is,{results:m}),s.viewMode==="heatmap"&&e.jsx(ds,{results:m})]})]}),s.showComparison&&s.selectedSymbols.size>0&&e.jsx(ms,{symbols:Array.from(s.selectedSymbols),results:m.filter(h=>s.selectedSymbols.has(h.symbol)),onClose:()=>t(h=>({...h,showComparison:!1}))}),e.jsx(hs,{isOpen:l,onClose:()=>c(!1)}),e.jsx(bs,{isOpen:x,onClose:()=>a(!1),onRestore:h=>{t(f=>({...f,symbols:h.symbols,timeframes:h.timeframes}))}})]})})};export{ys as default};
